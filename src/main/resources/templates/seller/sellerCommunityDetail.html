<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        .line-limit{
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        .font{
            font-size: 0.8em;
        }

        a{
            text-decoration: none;
            color:black;
        }
    </style>
</head>
<body class="bg-body-secondary">
<div style="width:800px; margin-left:10%;">
    <div class="row mt-3">
        <div class="col">
            <span class="fw-bold">점주 커뮤니티 게시판</span>
        </div>
    </div>
    <div class="row  bg-white">
        <div class="col">
            <div class="row">
                <div class="col">
                    <span class="fw-bold fs-1" th:text="${sellerCommunityDetail.selectSellerCommunityById.sellerCommunityTitle}"></span>
                </div>
            </div>
            <div class="row border-bottom border-dark">
                <div class="col-md-auto">
                    <span><i class="bi-person-circle fs-1"></i></span>
                </div>
                <div class="col g-0">
                    <div class="row">
                        <div class="col">
                            <span th:text="${sellerCommunityDetail.sellerName.sellerName}"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <span th:text="${sellerCommunityDetail.selectSellerCommunityById.sellerCommunityCreatedAt}">2024.11.12 09:23</span>
                            <span><i class="bi-eye"></i></span>
                            <span th:text="${sellerCommunityDetail.selectSellerCommunityById.sellerCommunityVisitCount}">0</span>
                        </div>
                    </div>
                </div>
            </div>
            <div th:each="image : ${sellerCommunityDetail.selectImageListById}" class="row">
                <div class="col">
                    <img class="img-fluid" th:src="@{|/images/${image.sellerCommunityImageList}|}" alt="">
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <span th:text="${sellerCommunityDetail.selectSellerCommunityById.sellerCommunityContent}"></span>
                </div>
            </div>
            <div class="row border-top border-dark py-2">
                <div class="col">
                    <a th:if="${session.sellerDto!=null}" th:href="@{/seller/sellerCommunityLikeProcess(sellerCommunityNumber=${sellerCommunityDetail.selectSellerCommunityById.sellerCommunityNumber},sellerNumber=${session.sellerDto.sellerNumber},sellerCommunityNumber=${sellerCommunityDetail.selectSellerCommunityById.sellerCommunityNumber})}">
                        <span th:if="${checkIfSellerCommunityLikeExists!=0}">
                            <i class="bi-heart-fill text-danger"></i>
                        </span>
                        <span th:if="${checkIfSellerCommunityLikeExists==0}">
                             <i class="bi-heart text-danger"></i>
                        </span>
                    </a>
                    <a th:if="${session.sellerDto==null}" href="/login/sellerLogin">
                        <i class="bi-heart text-danger"></i>
                    </a>
                    <span>좋아요</span>
                    <span th:text="${sellerCommunityDetail.selectSellerCommunityLikeCount}">0</span>
                    <span><i class="bi bi-chat-dots"></i></span>
                    <span>댓글</span>
                    <span>2</span>
                </div>
            </div>
            <div th:each="sellerComment : ${sellerCommunityDetail.selectSellerCommunityComment}" class="row border-top border-bottom chatContainer">
                <div class="col">
                    <div class="row">
                        <div class="col-md-auto">
                            <span><i class="bi-person-circle fs-2"></i></span>
                        </div>
                        <div class="col g-0">
                            <div class="row">
                                <div class="col">
                                    <span th:text="${sellerComment.sellerCommunityCommentDto.sellerName}">semin06133</span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <span th:text="${sellerComment.sellerCommunityCommentDto.sellerCommunityCommentContent}"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <span th:text="${#dates.format(sellerComment.sellerCommunityCommentDto.sellerCommunityCommentCreatedAt,'yyyy.MM.dd HH:mm')}"></span>
                                    <span th:if="${session.sellerDto!=null}" style="cursor:pointer;" onclick="addReply(this)">답글쓰기</span>
                                    <a href="/login/sellerLogin" th:if="${session.sellerDto==null}">답글쓰기</a>
                                </div>
                                <div class="col text-end me-2">
                                    <span><i class="bi bi-hand-thumbs-up"></i></span>
                                    <span>0</span>
                                    <span><i class="bi bi-hand-thumbs-down"></i></span>
                                    <span>0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <form action="/seller/sellerCommunityReplyInsertProcess"  class="row addReply d-none">
                        <input type="hidden" name="sellerCommunityNumber" th:value="${sellerComment.sellerCommunityCommentDto.sellerCommunityNumber}">
                        <input type="hidden" name="sellerCommunityCommentNumber" th:value="${sellerComment.sellerCommunityCommentDto.sellerCommunityCommentNumber}">
                        <input th:if="${session.sellerDto!=null}" type="hidden" name="sellerNumber" th:value="${session.sellerDto.sellerNumber}">
                        <div class="col">
                            <div class="row">
                                <div class="col-10">
                                    <textarea class="form-control" name="sellerCommunityReplyContent" placeholder="대댓글쓰기"></textarea>
                                </div>
                                <div class="col">
                                    <input class="form-control btn btn-primary" type="submit" value="작성">
                                </div>
                            </div>
                        </div>
                    </form>
                    <div th:each="sellerReply : ${sellerComment.selectSellerCommunityReply}" class="row border-top">
                        <div class="col ms-5">
                            <div class="row">
                                <div class="col-md-auto">
                                    <span><i class="bi-person-circle fs-2"></i></span>
                                </div>
                                <div class="col g-0">
                                    <div class="row">
                                        <div class="col">
                                            <span th:text="${sellerReply.sellerName}"></span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <span th:text="${sellerReply.sellerCommunityReplyContent}"></span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <span th:text="${#dates.format(sellerReply.sellerCommunityReplyCreatedAt,'yyyy.MM.dd HH:ss')}">2024.05.13 15:48</span>
                                        </div>
                                        <div class="col text-end me-2">
                                            <span><i class="bi bi-hand-thumbs-up"></i></span>
                                            <span>0</span>
                                            <span><i class="bi bi-hand-thumbs-down"></i></span>
                                            <span>0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <form action="/seller/sellerCommunityCommentInsertProcess" class="row">
                <input type="hidden" name="sellerCommunityNumber" th:value="${sellerCommunityDetail.selectSellerCommunityById.sellerCommunityNumber}">
                <input th:if="${session.sellerDto!=null}"  type="hidden" name="sellerNumber"  th:value="${session.sellerDto.sellerNumber}">
                <div class="col-10">
                    <textarea class="form-control" name="sellerCommunityCommentContent" placeholder="댓글쓰기"></textarea>
                </div>
                <div class="col">
                    <input class=" form-control btn btn-primary" type="submit" value="작성">
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    function updateComment(target) {
        const clickedElement = target.closest(".chatContainer");
        const showEditBox = clickedElement.querySelector(".updateComment");
        const hideEditBox = document.querySelectorAll(".updateComment");
        for (const e of hideEditBox) {
            if(e !==showEditBox) {
                e.classList.add("d-none");
                e.classList.remove("d-block");
            }
        }
        if (showEditBox.classList.contains("d-none")) {
            showEditBox.classList.add("d-block");
            showEditBox.classList.remove("d-none");
        } else if (showEditBox.classList.contains("d-block")) {
            showEditBox.classList.add("d-none");
            showEditBox.classList.remove("d-block");
        }
    }
    function addReply(target) {
        const clickedElement = target.closest(".chatContainer");
        const showEditBox = clickedElement.querySelector(".addReply");
        const hideEditBox = document.querySelectorAll(".addReply");
        for (const e of hideEditBox) {
            if(e !==showEditBox) {
                e.classList.add("d-none");
                e.classList.remove("d-block");
            }
        }
        if (showEditBox.classList.contains("d-none")) {
            showEditBox.classList.add("d-block");
            showEditBox.classList.remove("d-none");
        } else if (showEditBox.classList.contains("d-block")) {
            showEditBox.classList.add("d-none");
            showEditBox.classList.remove("d-block");
        }
    }
    function updateReply(target) {
        const clickedElement = target.closest(".replyContainer");
        const showEditBox = clickedElement.querySelector(".updateReply");
        const hideEditBox = document.querySelectorAll(".updateReply");
        for (const e of hideEditBox) {
            if(e !==showEditBox) {
                e.classList.add("d-none");
                e.classList.remove("d-block");
            }
        }
        if (showEditBox.classList.contains("d-none")) {
            showEditBox.classList.add("d-block");
            showEditBox.classList.remove("d-none");
        } else if (showEditBox.classList.contains("d-block")) {
            showEditBox.classList.add("d-none");
            showEditBox.classList.remove("d-block");
        }
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>